#!/bin/sh

# TODO: Rename to load-pam-env, load this in profile.

# Load ~/.pam_environment if pam_env.so does not have user_readenv=1.
# Necessary on certain Linux distros.
if [ -z "${PAM_ENV_LOADED}" ]; then
	grep -v '^$' "${HOME}/.pam_environment" \
	  | grep -v '^#' \
	  | sed -r 's/ +DEFAULT//' \
	  | sed -r 's/@\{HOME\}/$\{HOME\}/' \
	  | sed -r 's/@\{SHELL\}/$\{SHELL\}/' \
	  | while read -r line; do
	    export "$(echo "${line}" | envsubst)"
	  done
fi

# TODO: Stick PATH into ~/.pam_environment.
# Remove this, put a note at the top saying it should go in profile?
. "${XDG_CONFIG_HOME}/sh/path"
